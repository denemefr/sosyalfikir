<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>HonorOfNations İlan Sayfası</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f4f4f4; }
    header { background: #333; color: #fff; padding: 15px; text-align: center; font-size: 20px; }
    .container { padding: 20px; }
    .form-box { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    label { display:block; margin-top:10px; font-weight: bold; }
    input, textarea, select, button { width: 100%; padding: 8px; margin-top:5px; border:1px solid #ccc; border-radius:5px; }
    button { background: #333; color: white; cursor: pointer; font-weight: bold; }
    button:hover { background: #555; }
    .messages { margin-top: 20px; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .message { background: #e0f7fa; margin: 10px 0; padding: 12px; border-radius: 10px; white-space: pre-line; }
    .note { margin-top: 10px; font-size: 12px; color: #666; }
    .error { color: red; font-weight: bold; margin-top: 10px; }
  </style>
</head>
<body>

<header>HonorOfNations İlan Sayfası</header>

<div class="container">
  <!-- İlan Formu -->
  <div class="form-box">
    <h3>İlan Oluştur</h3>
    <label>Satıcı / Alıcı</label>
    <select id="ilanType">
      <option value="Satıcı">Satıcı</option>
      <option value="Alıcı">Alıcı</option>
    </select>

    <label>İtem </label>
    <input type="text" id="item" placeholder="Örn: +9 iB ">

    <label>İletişim</label>
    <input type="text" id="iletisim" placeholder="Örn: 0530 .....">

    <label>Fiyat</label>
    <input type="text" id="price" placeholder="Örn: 100 Gb veya 100 Tl">

    <label>Ek Bilgi</label>
    <textarea id="extra" placeholder="Örn: Takas yapılmaz, Sadece Gold"></textarea>

    <button onclick="createMessage()">İlanı Yayınla</button>
    <div id="errorBox" class="error"></div>
    <div class="note">
      ⚠️ Flood kuralı: 2 saat dolmadan tekrar ilan paylaşılamaz.
      <br> ⚠️ Güvenli Ticaret için Referans/teyit almanız sizin için riski azaltır.
    </div>
  </div>

  <!-- Mesajlar -->
  <div class="messages" id="chatArea">
    <h3>Yayınlanan İlanlar</h3>
  </div>
</div>

<script>
  const ILAN_SURE = 24 * 60 * 60 * 1000; // 24 saat

  function loadMessages() {
    const chatArea = document.getElementById("chatArea");
    chatArea.innerHTML = "<h3>Yayınlanan İlanlar</h3>";

    let ilanlar = JSON.parse(localStorage.getItem("ilanlar")) || [];
    const now = Date.now();

    // 24 saati geçen ilanları filtrele
    ilanlar = ilanlar.filter(ilan => (now - ilan.time) < ILAN_SURE);

    // Ekrana bas
    ilanlar.forEach(ilan => {
      const div = document.createElement("div");
      div.className = "message";
      div.textContent = ilan.text;
      chatArea.appendChild(div);
    });

    // Güncel listeyi kaydet
    localStorage.setItem("ilanlar", JSON.stringify(ilanlar));
  }

  function createMessage() {
    const ilanType = document.getElementById("ilanType").value;
    const item = document.getElementById("item").value.trim();
    const iletisim = document.getElementById("iletisim").value.trim();
    const price = document.getElementById("price").value.trim();
    const extra = document.getElementById("extra").value.trim();
    const errorBox = document.getElementById("errorBox");

    const now = Date.now();
    const lastPost = localStorage.getItem("lastPostTime");

    if (lastPost && (now - lastPost) < 7200000) { // 2 saat
      const remaining = Math.ceil((7200000 - (now - lastPost)) / 60000);
      errorBox.textContent = "❌ Yeni ilan için " + remaining + " dakika beklemelisin.";
      return;
    }

    if (!item || !price) {
      errorBox.textContent = "❌ Lütfen item ve fiyat alanlarını doldurun.";
      return;
    }

    errorBox.textContent = "";

    const msg =
`[${ilanType}]
Item: ${item}
İletişim: ${iletisim}
Fiyat: ${price}
${extra ? "Not: " + extra : ""}
---
⚠️ Güvenli Ticaret için Referans/teyit almanız sizin için riski azaltır.`;

    // İlanı kaydet
    let ilanlar = JSON.parse(localStorage.getItem("ilanlar")) || [];
    ilanlar.push({ text: msg, time: now });
    localStorage.setItem("ilanlar", JSON.stringify(ilanlar));

    localStorage.setItem("lastPostTime", now);

    // Formu temizle
    document.getElementById("item").value = "";
    document.getElementById("iletisim").value = "";
    document.getElementById("price").value = "";
    document.getElementById("extra").value = "";

    loadMessages();
  }

  // Sayfa açıldığında eski ilanları kontrol et
  window.onload = loadMessages;
</script>

</body>
</html>
